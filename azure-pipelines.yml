# .NET Desktop
# Build and run tests for .NET Desktop or Windows classic desktop solutions.
# Add steps that publish symbols, save build artifacts, and more:
# https://docs.microsoft.com/azure/devops/pipelines/apps/windows/dot-net

pr:
- main

pool:
  vmImage: 'windows-latest'

steps:
- task: NuGetToolInstaller@1
- script: dotnet tool update dotnet-script --global
- script: dotnet tool update dotnet-coverage --global
- script: dotnet tool update dotnet-sonarscanner --global

- task: NuGetCommand@2
  inputs:
    restoreSolution: '**/*.sln'

- script: dotnet build --no-incremental --no-restore
- script: dotnet-coverage collect "dotnet test --no-restore --no-build" -f xml -o "coverage.xml"
- script: dotnet publish -o ./publish --no-restore --no-build --self-contained -r win-x64 -f net8.0