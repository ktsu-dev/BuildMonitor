# .NET Desktop
# Build and run tests for .NET Desktop or Windows classic desktop solutions.
# Add steps that publish symbols, save build artifacts, and more:
# https://docs.microsoft.com/azure/devops/pipelines/apps/windows/dot-net

pr:
- main

pool:
  vmImage: 'windows-latest'

steps:
- script: dotnet tool update dotnet-script --global
  displayName: Install dotnet-script

- script: dotnet tool update dotnet-coverage --global
  displayName: Install dotnet-coverage

- script: dotnet tool update dotnet-sonarscanner --global
  displayName: Install dotnet-sonarscanner

- script: dotnet restore -r win-x64
  displayName: Restore

- script: dotnet build --no-restore --no-incremental -c Release -r win-x64 -f net8.0
  displayName: Build

- script: dotnet-coverage collect "dotnet test --no-restore --no-build" -f xml -o "coverage.xml"
  displayName: Test

- script: dotnet publish -o ./publish --no-restore --no-build --self-contained -c Release -r win-x64 -f net8.0
  displayName: Publish